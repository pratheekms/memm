Loading dataset
Done
Profiling started
Preprocessing for gradient
Done
before training:  2015-01-20 12:31:08.307721
[ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]
802.682582072 0.0 802.682582072 0.0
[  1.00000000e-08   0.00000000e+00   0.00000000e+00   0.00000000e+00
   0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
   0.00000000e+00   0.00000000e+00]
802.682582025 1.22e-06 802.682583245 0.0
[  0.00000000e+00   1.00000000e-08   0.00000000e+00   0.00000000e+00
   0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
   0.00000000e+00   0.00000000e+00]
802.682582059 1.19e-06 802.682583249 0.0
[  0.00000000e+00   0.00000000e+00   1.00000000e-08   0.00000000e+00
   0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
   0.00000000e+00   0.00000000e+00]
802.68258215 1.09e-06 802.68258324 0.0
[  0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e-08
   0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
   0.00000000e+00   0.00000000e+00]
802.682582027 1.24e-06 802.682583267 0.0
[  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
   1.00000000e-08   0.00000000e+00   0.00000000e+00   0.00000000e+00
   0.00000000e+00   0.00000000e+00]
802.682582165 1.07e-06 802.682583235 0.0
[  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
   0.00000000e+00   1.00000000e-08   0.00000000e+00   0.00000000e+00
   0.00000000e+00   0.00000000e+00]
802.682582075 1.18e-06 802.682583255 0.0
[  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
   0.00000000e+00   0.00000000e+00   1.00000000e-08   0.00000000e+00
   0.00000000e+00   0.00000000e+00]
802.682582034 1.23e-06 802.682583264 0.0
[  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
   0.00000000e+00   0.00000000e+00   0.00000000e+00   1.00000000e-08
   0.00000000e+00   0.00000000e+00]
802.682582027 1.23e-06 802.682583257 0.0
[  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
   0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
   1.00000000e-08   0.00000000e+00]
802.682582143 1.13e-06 802.682583273 0.0
[  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
   0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
   0.00000000e+00   1.00000000e-08]
802.682581986 1.26e-06 802.682583246 0.0
[ 0.25082237  0.07116971 -0.41620639  0.24192874 -0.49447281 -0.01243228
  0.20457486  0.24015062 -0.37707439  0.46249273]
822.435781135 29.8907071985 852.326488334 0.0
[ 0.25082238  0.07116971 -0.41620639  0.24192874 -0.49447281 -0.01243228
  0.20457486  0.24015062 -0.37707439  0.46249273]
821.501040048 30.4001098604 851.901149908 0.0
[ 0.25082237  0.07116972 -0.41620639  0.24192874 -0.49447281 -0.01243228
  0.20457486  0.24015062 -0.37707439  0.46249273]
840.140789132 12.1879108504 852.328699982 0.0
[ 0.25082237  0.07116971 -0.41620638  0.24192874 -0.49447281 -0.01243228
  0.20457486  0.24015062 -0.37707439  0.46249273]
823.340911902 29.2037491041 852.544661006 0.0
[ 0.25082237  0.07116971 -0.41620639  0.24192875 -0.49447281 -0.01243228
  0.20457486  0.24015062 -0.37707439  0.46249273]
811.526936003 40.3661107144 851.893046718 0.0
[ 0.25082237  0.07116971 -0.41620639  0.24192874 -0.4944728  -0.01243228
  0.20457486  0.24015062 -0.37707439  0.46249273]
824.374622399 27.5775276715 851.952150071 0.0
[ 0.25082237  0.07116971 -0.41620639  0.24192874 -0.49447281 -0.01243227
  0.20457486  0.24015062 -0.37707439  0.46249273]
823.645529544 28.2868071915 851.932336735 0.0
[ 0.25082237  0.07116971 -0.41620639  0.24192874 -0.49447281 -0.01243228
  0.20457487  0.24015062 -0.37707439  0.46249273]
832.812414273 17.2996093131 850.112023586 0.0
[ 0.25082237  0.07116971 -0.41620639  0.24192874 -0.49447281 -0.01243228
  0.20457486  0.24015063 -0.37707439  0.46249273]
842.384534279 9.99646674038 852.38100102 0.0
[ 0.25082237  0.07116971 -0.41620639  0.24192874 -0.49447281 -0.01243228
  0.20457486  0.24015062 -0.37707438  0.46249273]
831.366383232 19.2849388801 850.651322112 0.0
[ 0.25082237  0.07116971 -0.41620639  0.24192874 -0.49447281 -0.01243228
  0.20457486  0.24015062 -0.37707439  0.46249274]
840.09612458 10.6627954273 850.758920007 0.0
[ 0.11413483  0.03238524 -0.18939157  0.11008785 -0.22500612 -0.00565722
  0.09309025  0.10927872 -0.17158485  0.21045382]
810.88427806 6.74767256624 817.631950626 0.0
[ 0.11413484  0.03238524 -0.18939157  0.11008785 -0.22500612 -0.00565722
  0.09309025  0.10927872 -0.17158485  0.21045382]
811.035514082 7.03526847002 818.070782552 0.0
[ 0.11413483  0.03238525 -0.18939157  0.11008785 -0.22500612 -0.00565722
  0.09309025  0.10927872 -0.17158485  0.21045382]
807.442370987 10.0493528094 817.491723796 0.0
[ 0.11413483  0.03238524 -0.18939156  0.11008785 -0.22500612 -0.00565722
  0.09309025  0.10927872 -0.17158485  0.21045382]
818.408805391 0.644862364784 819.053667756 0.0
[ 0.11413483  0.03238524 -0.18939157  0.11008786 -0.22500612 -0.00565722
  0.09309025  0.10927872 -0.17158485  0.21045382]
811.273655618 6.47289188854 817.746547507 0.0
[ 0.11413483  0.03238524 -0.18939157  0.11008785 -0.22500611 -0.00565722
  0.09309025  0.10927872 -0.17158485  0.21045382]
809.036399696 8.72544707973 817.761846776 0.0
[ 0.11413483  0.03238524 -0.18939157  0.11008785 -0.22500612 -0.00565721
  0.09309025  0.10927872 -0.17158485  0.21045382]
804.881486538 13.2347105656 818.116197104 0.0
[ 0.11413483  0.03238524 -0.18939157  0.11008785 -0.22500612 -0.00565722
  0.09309026  0.10927872 -0.17158485  0.21045382]
807.986132141 9.91906650438 817.905198646 0.0
[ 0.11413483  0.03238524 -0.18939157  0.11008785 -0.22500612 -0.00565722
  0.09309025  0.10927873 -0.17158485  0.21045382]
806.04525736 11.5145632397 817.559820599 0.0
[ 0.11413483  0.03238524 -0.18939157  0.11008785 -0.22500612 -0.00565722
  0.09309025  0.10927872 -0.17158484  0.21045382]
807.66734138 9.55959074671 817.226932127 0.0
[ 0.11413483  0.03238524 -0.18939157  0.11008785 -0.22500612 -0.00565722
  0.09309025  0.10927872 -0.17158485  0.21045383]
809.040384504 9.06037100332 818.100755508 0.0
[  2.92916931e-09   8.31138544e-10  -4.86056712e-09   2.82530710e-09
  -5.77458289e-09  -1.45187464e-10   2.38907875e-09   2.80454175e-09
  -4.40357341e-09   5.40111111e-09]
802.682582114 2.10673379774e-07 802.682582325 0.0
[  1.29291693e-08   8.31138544e-10  -4.86056712e-09   2.82530710e-09
  -5.77458289e-09  -1.45187464e-10   2.38907875e-09   2.80454175e-09
  -4.40357341e-09   5.40111111e-09]
802.682581958 1.53234844885e-06 802.682583491 0.0
[  2.92916931e-09   1.08311385e-08  -4.86056712e-09   2.82530710e-09
  -5.77458289e-09  -1.45187464e-10   2.38907875e-09   2.80454175e-09
  -4.40357341e-09   5.40111111e-09]
802.682582104 1.39835466309e-06 802.682583502 0.0
[  2.92916931e-09   8.31138544e-10   5.13943288e-09   2.82530710e-09
  -5.77458289e-09  -1.45187464e-10   2.38907875e-09   2.80454175e-09
  -4.40357341e-09   5.40111111e-09]
802.682582193 1.31241524304e-06 802.682583505 0.0
[  2.92916931e-09   8.31138544e-10  -4.86056712e-09   1.28253071e-08
  -5.77458289e-09  -1.45187464e-10   2.38907875e-09   2.80454175e-09
  -4.40357341e-09   5.40111111e-09]
802.682582251 1.25530054027e-06 802.682583507 0.0
[  2.92916931e-09   8.31138544e-10  -4.86056712e-09   2.82530710e-09
   4.22541711e-09  -1.45187464e-10   2.38907875e-09   2.80454175e-09
  -4.40357341e-09   5.40111111e-09]
802.68258191 1.56110477634e-06 802.682583471 0.0
[  2.92916931e-09   8.31138544e-10  -4.86056712e-09   2.82530710e-09
  -5.77458289e-09   9.85481254e-09   2.38907875e-09   2.80454175e-09
  -4.40357341e-09   5.40111111e-09]
802.682582172 1.30506781729e-06 802.682583478 0.0
[  2.92916931e-09   8.31138544e-10  -4.86056712e-09   2.82530710e-09
  -5.77458289e-09  -1.45187464e-10   1.23890787e-08   2.80454175e-09
  -4.40357341e-09   5.40111111e-09]
802.682581936 1.55405242648e-06 802.68258349 0.0
[  2.92916931e-09   8.31138544e-10  -4.86056712e-09   2.82530710e-09
  -5.77458289e-09  -1.45187464e-10   2.38907875e-09   1.28045417e-08
  -4.40357341e-09   5.40111111e-09]
802.68258215 1.33599421722e-06 802.682583486 0.0
[  2.92916931e-09   8.31138544e-10  -4.86056712e-09   2.82530710e-09
  -5.77458289e-09  -1.45187464e-10   2.38907875e-09   2.80454175e-09
   5.59642659e-09   5.40111111e-09]
802.682581921 1.55815607117e-06 802.682583479 0.0
[  2.92916931e-09   8.31138544e-10  -4.86056712e-09   2.82530710e-09
  -5.77458289e-09  -1.45187464e-10   2.38907875e-09   2.80454175e-09
  -4.40357341e-09   1.54011111e-08]
802.682581924 1.52072658283e-06 802.682583444 0.0
[  7.35653029e-10   2.08738220e-10  -1.22071842e-09   7.09568313e-10
  -1.45027103e-09  -3.64634429e-11   6.00010730e-10   7.04353150e-10
  -1.10594567e-09   1.35647459e-09]
802.682582031 1.01848121711e-07 802.682582133 0.0
[  1.07356530e-08   2.08738220e-10  -1.22071842e-09   7.09568313e-10
  -1.45027103e-09  -3.64634429e-11   6.00010730e-10   7.04353150e-10
  -1.10594567e-09   1.35647459e-09]
802.682582176 1.14968462141e-06 802.682583326 0.0
[  7.35653029e-10   1.02087382e-08  -1.22071842e-09   7.09568313e-10
  -1.45027103e-09  -3.64634429e-11   6.00010730e-10   7.04353150e-10
  -1.10594567e-09   1.35647459e-09]
802.682582038 1.27089654201e-06 802.682583309 0.0
[  7.35653029e-10   2.08738220e-10   8.77928158e-09   7.09568313e-10
  -1.45027103e-09  -3.64634429e-11   6.00010730e-10   7.04353150e-10
  -1.10594567e-09   1.35647459e-09]
802.68258198 1.31798008579e-06 802.682583298 0.0
[  7.35653029e-10   2.08738220e-10  -1.22071842e-09   1.07095683e-08
  -1.45027103e-09  -3.64634429e-11   6.00010730e-10   7.04353150e-10
  -1.10594567e-09   1.35647459e-09]
802.682582193 1.11959436311e-06 802.682583312 0.0
[  7.35653029e-10   2.08738220e-10  -1.22071842e-09   7.09568313e-10
   8.54972897e-09  -3.64634429e-11   6.00010730e-10   7.04353150e-10
  -1.10594567e-09   1.35647459e-09]
802.682582094 1.20196622974e-06 802.682583296 0.0
[  7.35653029e-10   2.08738220e-10  -1.22071842e-09   7.09568313e-10
  -1.45027103e-09   9.96353656e-09   6.00010730e-10   7.04353150e-10
  -1.10594567e-09   1.35647459e-09]
802.682582067 1.23452827372e-06 802.682583301 0.0
[  7.35653029e-10   2.08738220e-10  -1.22071842e-09   7.09568313e-10
  -1.45027103e-09  -3.64634429e-11   1.06000107e-08   7.04353150e-10
  -1.10594567e-09   1.35647459e-09]
802.682581925 1.37530513915e-06 802.6825833 0.0
[  7.35653029e-10   2.08738220e-10  -1.22071842e-09   7.09568313e-10
  -1.45027103e-09  -3.64634429e-11   6.00010730e-10   1.07043531e-08
  -1.10594567e-09   1.35647459e-09]
802.682582184 1.11571092551e-06 802.682583299 0.0
[  7.35653029e-10   2.08738220e-10  -1.22071842e-09   7.09568313e-10
  -1.45027103e-09  -3.64634429e-11   6.00010730e-10   7.04353150e-10
   8.89405433e-09   1.35647459e-09]
802.682582043 1.26906171894e-06 802.682583312 0.0
[  7.35653029e-10   2.08738220e-10  -1.22071842e-09   7.09568313e-10
  -1.45027103e-09  -3.64634429e-11   6.00010730e-10   7.04353150e-10
  -1.10594567e-09   1.13564746e-08]
802.682582077 1.21605514234e-06 802.682583293 0.0
after training:  2015-01-20 12:31:13.983598   total time =  5.675877
         13532152 function calls in 5.763 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    5.676    5.676 /home/pratheek/work/memm/mach_1 - python single machine no spark /memm.py:74(train)
        1    0.000    0.000    5.676    5.676 /usr/lib/python2.7/site-packages/scipy/optimize/_minimize.py:37(minimize)
        1    0.000    0.000    5.676    5.676 /usr/lib/python2.7/site-packages/scipy/optimize/lbfgsb.py:199(_minimize_lbfgsb)
        5    0.000    0.000    5.676    1.135 /usr/lib/python2.7/site-packages/scipy/optimize/lbfgsb.py:260(func_and_grad)
       55    0.000    0.000    5.675    0.103 /usr/lib/python2.7/site-packages/scipy/optimize/optimize.py:280(function_wrapper)
       55    0.528    0.010    5.675    0.103 /home/pratheek/work/memm/mach_1 - python single machine no spark /memm.py:54(cost)
        5    0.001    0.000    5.162    1.032 /usr/lib/python2.7/site-packages/scipy/optimize/optimize.py:544(_approx_fprime_helper)
   409460    1.513    0.000    4.071    0.000 /home/pratheek/work/memm/mach_1 - python single machine no spark /memm.py:50(get_features)
   402380    1.026    0.000    1.026    0.000 {numpy.core.multiarray.dot}
  4094600    0.620    0.000    0.620    0.000 {round}
   409460    0.199    0.000    0.347    0.000 run.py:39(f1)
  4094600    0.288    0.000    0.288    0.000 {method 'random' of '_random.Random' objects}
   409460    0.166    0.000    0.252    0.000 run.py:42(f2)
   409460    0.164    0.000    0.251    0.000 run.py:54(f6)
   409460    0.161    0.000    0.247    0.000 run.py:45(f3)
   409460    0.161    0.000    0.246    0.000 run.py:57(f7)
   409460    0.161    0.000    0.245    0.000 run.py:66(f10)
   409460    0.160    0.000    0.244    0.000 run.py:51(f5)
   409460    0.159    0.000    0.243    0.000 run.py:63(f9)
   409460    0.159    0.000    0.241    0.000 run.py:48(f4)
   409460    0.159    0.000    0.241    0.000 run.py:60(f8)
        1    0.011    0.011    0.087    0.087 /home/pratheek/work/memm/mach_1 - python single machine no spark /memm.py:10(__init__)
   389400    0.080    0.000    0.080    0.000 {math.exp}
       55    0.000    0.000    0.035    0.001 /usr/lib/python2.7/site-packages/numpy/core/numeric.py:1681(array_str)
       55    0.000    0.000    0.035    0.001 /usr/lib/python2.7/site-packages/numpy/core/arrayprint.py:343(array2string)
       55    0.002    0.000    0.034    0.001 /usr/lib/python2.7/site-packages/numpy/core/arrayprint.py:233(_array2string)
       55    0.001    0.000    0.015    0.000 /usr/lib/python2.7/site-packages/numpy/core/arrayprint.py:465(_formatArray)
      165    0.000    0.000    0.013    0.000 /usr/lib/python2.7/site-packages/numpy/core/arrayprint.py:533(__init__)
      165    0.007    0.000    0.013    0.000 /usr/lib/python2.7/site-packages/numpy/core/arrayprint.py:547(fillFormat)
      550    0.007    0.000    0.013    0.000 /usr/lib/python2.7/site-packages/numpy/core/arrayprint.py:598(__call__)
       55    0.000    0.000    0.008    0.000 /usr/lib/python2.7/site-packages/numpy/core/arrayprint.py:700(__init__)
     1430    0.003    0.000    0.006    0.000 /usr/lib/python2.7/site-packages/numpy/core/numeric.py:2428(seterr)
      191    0.005    0.000    0.005    0.000 {numpy.core.multiarray.array}
    12980    0.005    0.000    0.005    0.000 {math.log}
      715    0.001    0.000    0.004    0.000 /usr/lib/python2.7/site-packages/numpy/core/numeric.py:2813(__enter__)
      715    0.001    0.000    0.004    0.000 /usr/lib/python2.7/site-packages/numpy/core/numeric.py:2818(__exit__)
      428    0.002    0.000    0.002    0.000 {method 'reduce' of 'numpy.ufunc' objects}
     1430    0.002    0.000    0.002    0.000 /usr/lib/python2.7/site-packages/numpy/core/numeric.py:2524(geterr)
       55    0.001    0.000    0.002    0.000 /usr/lib/python2.7/site-packages/numpy/core/arrayprint.py:639(__init__)
      102    0.000    0.000    0.001    0.000 /usr/lib/python2.7/site-packages/numpy/core/fromnumeric.py:1764(any)
      550    0.001    0.000    0.001    0.000 /usr/lib/python2.7/site-packages/numpy/core/arrayprint.py:457(_extendLine)
     7082    0.001    0.000    0.001    0.000 {method 'get' of 'dict' objects}
     1430    0.001    0.000    0.001    0.000 {numpy.core.umath.seterrobj}
      440    0.001    0.000    0.001    0.000 /usr/lib/python2.7/site-packages/numpy/core/arrayprint.py:632(_digits)
      715    0.001    0.000    0.001    0.000 /usr/lib/python2.7/site-packages/numpy/core/numeric.py:2809(__init__)
      102    0.000    0.000    0.001    0.000 {method 'any' of 'numpy.ndarray' objects}
     7316    0.001    0.000    0.001    0.000 {method 'append' of 'list' objects}
      102    0.000    0.000    0.001    0.000 /usr/lib/python2.7/site-packages/numpy/core/_methods.py:37(_any)
       55    0.000    0.000    0.001    0.000 /usr/lib/python2.7/site-packages/numpy/core/fromnumeric.py:1283(ravel)
      165    0.001    0.000    0.001    0.000 {method 'compress' of 'numpy.ndarray' objects}
     2860    0.000    0.000    0.000    0.000 {numpy.core.umath.geterrobj}
     1856    0.000    0.000    0.000    0.000 {method 'rstrip' of 'str' objects}
     3155    0.000    0.000    0.000    0.000 {len}
       56    0.000    0.000    0.000    0.000 /usr/lib/python2.7/site-packages/numpy/core/numeric.py:394(asarray)
      102    0.000    0.000    0.000    0.000 /usr/lib/python2.7/site-packages/numpy/core/numeric.py:464(asanyarray)
       55    0.000    0.000    0.000    0.000 /usr/lib/python2.7/site-packages/numpy/core/arrayprint.py:716(__init__)
       55    0.000    0.000    0.000    0.000 /usr/lib/python2.7/site-packages/numpy/core/arrayprint.py:689(__init__)
       55    0.000    0.000    0.000    0.000 {sum}
      715    0.000    0.000    0.000    0.000 {method 'pop' of 'dict' objects}
      116    0.000    0.000    0.000    0.000 {range}
       99    0.000    0.000    0.000    0.000 {max}
       56    0.000    0.000    0.000    0.000 {method 'ravel' of 'numpy.ndarray' objects}
      165    0.000    0.000    0.000    0.000 /usr/lib/python2.7/site-packages/numpy/core/arrayprint.py:661(__init__)
      220    0.000    0.000    0.000    0.000 {issubclass}
       55    0.000    0.000    0.000    0.000 {_functools.reduce}
        2    0.000    0.000    0.000    0.000 {built-in method now}
      101    0.000    0.000    0.000    0.000 {min}
       21    0.000    0.000    0.000    0.000 {numpy.core.multiarray.zeros}
       55    0.000    0.000    0.000    0.000 /usr/lib/python2.7/site-packages/numpy/core/arrayprint.py:744(__init__)
       10    0.000    0.000    0.000    0.000 {method 'startswith' of 'str' objects}
        1    0.000    0.000    0.000    0.000 /usr/lib/python2.7/site-packages/numpy/core/getlimits.py:93(__new__)
        8    0.000    0.000    0.000    0.000 {method 'tostring' of 'numpy.ndarray' objects}
        1    0.000    0.000    0.000    0.000 {method 'total_seconds' of 'datetime.timedelta' objects}
        1    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 /usr/lib/python2.7/site-packages/scipy/optimize/optimize.py:275(wrap_function)
        2    0.000    0.000    0.000    0.000 {method 'strip' of 'str' objects}
        1    0.000    0.000    0.000    0.000 /usr/lib/python2.7/site-packages/scipy/optimize/optimize.py:105(__getattr__)
        1    0.000    0.000    0.000    0.000 /usr/lib/python2.7/site-packages/scipy/optimize/optimize.py:127(_check_unknown_options)
        1    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        2    0.000    0.000    0.000    0.000 {callable}
        1    0.000    0.000    0.000    0.000 {isinstance}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



