Loading dataset
Done
Profiling started
Preprocessing for gradient
Done
before training:  2015-01-20 12:34:19.719518
[ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]
802.682582072 0.0 802.682582072 0.0
[-12.83333333   7.03333333   1.73333333   6.1          2.56666667
   2.43333333   3.8          6.26666667  -9.63333333  -2.63333333]
[ 0.62595503 -0.34305587 -0.08454458 -0.29753187 -0.12519101 -0.11868758
 -0.18534772 -0.30566116  0.46987274  0.12844272]
821.955746125 -20.8629998196 801.092746305 0.0
[ 23.04332844 -12.39986256  -4.48243342 -10.32539847  -4.25846723
  -4.54459241  -6.59238515 -10.7466366   16.92564002   4.73285686]
[ 0.11389764 -0.06242182 -0.01538358 -0.05413836 -0.02277953 -0.02159618
 -0.03372553 -0.05561755  0.08549719  0.0233712 ]
804.794176893 -6.12443872447 798.669738168 0.0
[-6.16335558  3.47476321  0.63727439  3.10300793  1.29504035  1.19946924
  1.89486781  3.15834918 -4.72686445 -1.24476871]
[ 0.0156091  -0.0085546  -0.00210824 -0.00741939 -0.00312182 -0.00295965
 -0.00462191 -0.0076221   0.01171696  0.00320291]
802.743255705 -0.751669243333 801.991586461 0.0
[-11.92051087   6.54621926   1.58420346   5.69019245   2.39181225
   2.26509071   3.53899271   5.84127485  -8.96136621  -2.44219843]
[ 0.00291277 -0.00159635 -0.00039341 -0.00138451 -0.00058255 -0.00055229
 -0.00086248 -0.00142234  0.00218647  0.00059769]
802.671520527 -0.133586658841 802.537933868 0.0
[-12.66304662   6.94245279   1.70553094   6.02355353   2.53402441
   2.40195792   3.75129805   6.18730327  -9.50796033  -2.597648  ]
[ 0.01129235 -0.00618879 -0.0015252  -0.00536753 -0.00225847 -0.00214115
 -0.00334371 -0.00551419  0.00847659  0.00231713]
802.696732826 -0.512819227808 802.183913598 0.0
[-12.17302247   6.68095638   1.62548056   5.80356088   2.44015146
   2.31164511   3.61118021   5.95894167  -9.14722782  -2.49503335]
[ 0.00450694 -0.00247004 -0.00060873 -0.00214226 -0.00090139 -0.00085456
 -0.00133452 -0.00220079  0.00338313  0.0009248 ]
802.777872799 -0.279781740248 802.498091059 0.0
[-12.56983754   6.89270992   1.69030949   5.98170889   2.51616174
   2.38478221   3.72464253   6.14386392  -9.43933904  -2.5781208 ]
[ 0.00300488 -0.00164683 -0.00040585 -0.0014283  -0.00060098 -0.00056976
 -0.00088976 -0.00146732  0.00225561  0.00061659]
802.635240591 -0.0848470109757 802.55039358 0.0
[-12.65766129   6.93957876   1.70465156   6.02113589   2.53299227
   2.4009656    3.74975793   6.18479345  -9.50399554  -2.59651967]
[ 0.00300624 -0.00164757 -0.00040604 -0.00142894 -0.00060125 -0.00057001
 -0.00089016 -0.00146798  0.00225663  0.00061686]
802.685493925 -0.12405996644 802.561433958 0.0
[-12.65758223   6.93953657   1.70463865   6.0211004    2.53297712
   2.40095103   3.74973533   6.18475661  -9.50393734  -2.59650311]
[ 0.00300488 -0.00164683 -0.00040585 -0.0014283  -0.00060098 -0.00056976
 -0.00088976 -0.00146732  0.00225561  0.00061659]
802.653735616 -0.109424624586 802.544310992 0.0
[-12.65766129   6.93957876   1.70465156   6.02113589   2.53299227
   2.4009656    3.74975793   6.18479345  -9.50399554  -2.59651967]
[ 0.21962475 -0.12362488 -0.02326299 -0.11038352 -0.04581105 -0.04285942
 -0.06732491 -0.11229578  0.16812994  0.04407544]
807.933243543 -13.2406388849 794.692604658 0.0
[ 0.0238428  -0.00976927 -0.04320277 -0.02042212  0.01748029 -0.01492016
 -0.00109065 -0.01016739 -0.00379499 -0.02786359]
[ 0.03210212 -0.01803141 -0.00347612 -0.01606359 -0.00667377 -0.00625027
 -0.00981359 -0.01635424  0.02453651  0.00645415]
803.08177949 -1.85594255106 801.225836939 0.0
[-10.95508792   6.00728331   1.4738965    5.21196809   2.19275304
   2.07964413   3.24573516   5.35402355  -8.22763968  -2.24794137]
[ 0.00700316 -0.00389825 -0.00082774 -0.00343934 -0.00143544 -0.00135032
 -0.00211599 -0.00351294  0.00531725  0.00141873]
802.900290676 -0.539553254597 802.360737421 0.0
[-12.42384259   6.81152024   1.67301856   5.91001814   2.48620242
   2.35686825   3.68050773   6.07068389  -9.32866383  -2.54856692]
[ 0.00325246 -0.00178624 -0.00043198 -0.00155282 -0.00065265 -0.00061809
 -0.00096569 -0.00159399  0.00244519  0.00066626]
802.71305645 -0.163189716023 802.549866734 0.0
[-12.64318452   6.93164981   1.70269352   6.01425612   2.53009468
   2.39823558   3.74547002   6.1777282   -9.49313949  -2.59354993]
[ 0.00300997 -0.0016497  -0.00040639 -0.00143085 -0.00060204 -0.00057075
 -0.00089132 -0.00146992  0.00225951  0.00061761]
802.717736759 -0.167177141464 802.550559618 0.0
[-12.657364     6.93941594   1.70461135   6.02099461   2.53293276
   2.40090954   3.74966988   6.18464836  -9.5037726   -2.59645869]
[ 0.00300489 -0.00164683 -0.00040585 -0.0014283  -0.00060098 -0.00056976
 -0.00088976 -0.00146732  0.00225562  0.00061659]
802.617818537 -0.078439262695 802.539379274 0.0
[-12.65766116   6.93957869   1.70465154   6.02113582   2.53299224
   2.40096557   3.7497579    6.18479339  -9.50399544  -2.59651965]
[ 0.00300489 -0.00164683 -0.00040585 -0.0014283  -0.00060098 -0.00056976
 -0.00088976 -0.00146732  0.00225562  0.00061659]
802.72966599 -0.167992691882 802.561673298 0.0
[-12.65766116   6.93957869   1.70465154   6.02113582   2.53299224
   2.40096557   3.7497579    6.18479339  -9.50399544  -2.59651965]
[ 0.00300489 -0.00164683 -0.00040585 -0.0014283  -0.00060098 -0.00056976
 -0.00088976 -0.00146732  0.00225562  0.00061659]
802.704688831 -0.161943894391 802.542744936 0.0
[-12.65766116   6.93957869   1.70465154   6.02113582   2.53299224
   2.40096557   3.7497579    6.18479339  -9.50399544  -2.59651965]
after training:  2015-01-20 12:36:28.172654   total time =  128.453136
         82645842 function calls in 128.541 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  128.453  128.453 /home/pratheek/work/memm/mach_1 - python single machine no spark /memm.py:74(train)
        1    0.000    0.000  128.453  128.453 /usr/lib/python2.7/site-packages/scipy/optimize/_minimize.py:37(minimize)
        1    0.000    0.000  128.453  128.453 /usr/lib/python2.7/site-packages/scipy/optimize/lbfgsb.py:199(_minimize_lbfgsb)
       18    0.000    0.000  128.452    7.136 /usr/lib/python2.7/site-packages/scipy/optimize/lbfgsb.py:265(func_and_grad)
       18   67.538    3.752  126.304    7.017 /home/pratheek/work/memm/mach_1 - python single machine no spark /memm.py:82(gradient)
 39638088   51.257    0.000   51.257    0.000 {numpy.core.multiarray.dot}
 37396880    6.803    0.000    6.803    0.000 {math.exp}
       18    0.000    0.000    2.148    0.119 /usr/lib/python2.7/site-packages/scipy/optimize/optimize.py:280(function_wrapper)
       18    0.198    0.011    2.148    0.119 /home/pratheek/work/memm/mach_1 - python single machine no spark /memm.py:54(cost)
   138768    0.599    0.000    1.589    0.000 /home/pratheek/work/memm/mach_1 - python single machine no spark /memm.py:50(get_features)
  1274615    1.111    0.000    1.111    0.000 {numpy.core.multiarray.array}
  1387680    0.237    0.000    0.237    0.000 {round}
   138768    0.076    0.000    0.131    0.000 run.py:39(f1)
  1387680    0.110    0.000    0.110    0.000 {method 'random' of '_random.Random' objects}
   138768    0.064    0.000    0.098    0.000 run.py:42(f2)
   138768    0.064    0.000    0.097    0.000 run.py:54(f6)
   138768    0.064    0.000    0.096    0.000 run.py:66(f10)
   138768    0.063    0.000    0.096    0.000 run.py:57(f7)
   138768    0.063    0.000    0.096    0.000 run.py:45(f3)
   138768    0.063    0.000    0.095    0.000 run.py:51(f5)
   138768    0.063    0.000    0.095    0.000 run.py:63(f9)
   138768    0.063    0.000    0.094    0.000 run.py:60(f8)
   138768    0.062    0.000    0.093    0.000 run.py:48(f4)
        1    0.011    0.011    0.088    0.088 /home/pratheek/work/memm/mach_1 - python single machine no spark /memm.py:10(__init__)
       36    0.000    0.000    0.028    0.001 /usr/lib/python2.7/site-packages/numpy/core/numeric.py:1681(array_str)
       36    0.000    0.000    0.028    0.001 /usr/lib/python2.7/site-packages/numpy/core/arrayprint.py:343(array2string)
       36    0.001    0.000    0.027    0.001 /usr/lib/python2.7/site-packages/numpy/core/arrayprint.py:233(_array2string)
      108    0.000    0.000    0.012    0.000 /usr/lib/python2.7/site-packages/numpy/core/arrayprint.py:533(__init__)
      108    0.006    0.000    0.012    0.000 /usr/lib/python2.7/site-packages/numpy/core/arrayprint.py:547(fillFormat)
       36    0.001    0.000    0.011    0.000 /usr/lib/python2.7/site-packages/numpy/core/arrayprint.py:465(_formatArray)
      360    0.005    0.000    0.010    0.000 /usr/lib/python2.7/site-packages/numpy/core/arrayprint.py:598(__call__)
       36    0.000    0.000    0.007    0.000 /usr/lib/python2.7/site-packages/numpy/core/arrayprint.py:700(__init__)
      936    0.002    0.000    0.005    0.000 /usr/lib/python2.7/site-packages/numpy/core/numeric.py:2428(seterr)
      468    0.000    0.000    0.003    0.000 /usr/lib/python2.7/site-packages/numpy/core/numeric.py:2813(__enter__)
      468    0.001    0.000    0.003    0.000 /usr/lib/python2.7/site-packages/numpy/core/numeric.py:2818(__exit__)
     4248    0.002    0.000    0.002    0.000 {math.log}
      321    0.002    0.000    0.002    0.000 {method 'reduce' of 'numpy.ufunc' objects}
      936    0.002    0.000    0.002    0.000 /usr/lib/python2.7/site-packages/numpy/core/numeric.py:2524(geterr)
       36    0.001    0.000    0.002    0.000 /usr/lib/python2.7/site-packages/numpy/core/arrayprint.py:639(__init__)
      700    0.001    0.000    0.002    0.000 /usr/lib/python2.7/site-packages/numpy/core/arrayprint.py:632(_digits)
      109    0.000    0.000    0.001    0.000 /usr/lib/python2.7/site-packages/numpy/core/fromnumeric.py:1764(any)
     7082    0.001    0.000    0.001    0.000 {method 'get' of 'dict' objects}
      109    0.000    0.000    0.001    0.000 {method 'any' of 'numpy.ndarray' objects}
     7496    0.001    0.000    0.001    0.000 {method 'append' of 'list' objects}
      109    0.000    0.000    0.001    0.000 /usr/lib/python2.7/site-packages/numpy/core/_methods.py:37(_any)
      271    0.001    0.000    0.001    0.000 {range}
      936    0.001    0.000    0.001    0.000 {numpy.core.umath.seterrobj}
      360    0.001    0.000    0.001    0.000 /usr/lib/python2.7/site-packages/numpy/core/arrayprint.py:457(_extendLine)
      468    0.000    0.000    0.001    0.000 /usr/lib/python2.7/site-packages/numpy/core/numeric.py:2809(__init__)
     1815    0.000    0.000    0.000    0.000 {method 'rstrip' of 'str' objects}
      108    0.000    0.000    0.000    0.000 {method 'compress' of 'numpy.ndarray' objects}
     1872    0.000    0.000    0.000    0.000 {numpy.core.umath.geterrobj}
     3383    0.000    0.000    0.000    0.000 {len}
       36    0.000    0.000    0.000    0.000 /usr/lib/python2.7/site-packages/numpy/core/fromnumeric.py:1283(ravel)
      109    0.000    0.000    0.000    0.000 /usr/lib/python2.7/site-packages/numpy/core/numeric.py:464(asanyarray)
       37    0.000    0.000    0.000    0.000 /usr/lib/python2.7/site-packages/numpy/core/numeric.py:394(asarray)
       36    0.000    0.000    0.000    0.000 /usr/lib/python2.7/site-packages/numpy/core/arrayprint.py:716(__init__)
       36    0.000    0.000    0.000    0.000 /usr/lib/python2.7/site-packages/numpy/core/arrayprint.py:689(__init__)
      468    0.000    0.000    0.000    0.000 {method 'pop' of 'dict' objects}
      106    0.000    0.000    0.000    0.000 {max}
       37    0.000    0.000    0.000    0.000 {method 'ravel' of 'numpy.ndarray' objects}
      108    0.000    0.000    0.000    0.000 /usr/lib/python2.7/site-packages/numpy/core/arrayprint.py:661(__init__)
        2    0.000    0.000    0.000    0.000 {built-in method now}
       18    0.000    0.000    0.000    0.000 {sum}
      144    0.000    0.000    0.000    0.000 {issubclass}
       36    0.000    0.000    0.000    0.000 {_functools.reduce}
      108    0.000    0.000    0.000    0.000 {min}
       36    0.000    0.000    0.000    0.000 /usr/lib/python2.7/site-packages/numpy/core/arrayprint.py:744(__init__)
       11    0.000    0.000    0.000    0.000 {numpy.core.multiarray.zeros}
       25    0.000    0.000    0.000    0.000 {method 'startswith' of 'str' objects}
       22    0.000    0.000    0.000    0.000 {method 'tostring' of 'numpy.ndarray' objects}
        1    0.000    0.000    0.000    0.000 /usr/lib/python2.7/site-packages/numpy/core/getlimits.py:93(__new__)
        1    0.000    0.000    0.000    0.000 {method 'total_seconds' of 'datetime.timedelta' objects}
        1    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 /usr/lib/python2.7/site-packages/scipy/optimize/optimize.py:105(__getattr__)
        2    0.000    0.000    0.000    0.000 {method 'strip' of 'str' objects}
        2    0.000    0.000    0.000    0.000 {callable}
        1    0.000    0.000    0.000    0.000 /usr/lib/python2.7/site-packages/scipy/optimize/optimize.py:127(_check_unknown_options)
        1    0.000    0.000    0.000    0.000 {isinstance}
        1    0.000    0.000    0.000    0.000 /usr/lib/python2.7/site-packages/scipy/optimize/optimize.py:275(wrap_function)
        1    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



